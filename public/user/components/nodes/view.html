<div class='scroll post-view-section' layout="row" id='view_container'>

	<div flex>
		<!-- main -->
		<div class='post-container' style=" float:left;margin-left: 0px" layout='column'>

			<md-card class='post-details' layout='column' flex>

				<div class='post-title main move'> 
						<ng-md-icon icon="{{ post_details.type | post_icon }}" size='28' style="fill: #AFAFAF;" dnd-draggable='post_details' dnd-type="'post'">
							<md-tooltip md-direction="bottom">{{ post_details.type }}</md-tooltip>
						</ng-md-icon> 
						{{ post_details.title }}
				</div>
				
				<!-- <div layout="row">
					<a ui-sref='home.profile-details({address: post_details.createdBy})'>
						<img class='author-profile-picture main' src='{{getUser(post_details.createdBy).avatar}}'>
						<div class='author-name main'> {{ getUser(post_details.createdBy).name }}</div>
					</a>
				</div>
				
				<div class='tags'>
					<span class='pointer' ng-repeat='tag in post_details.tags | orderBy : "users"' ng-if='getTagName(tag.tag_id).length>0' ng-click='goToTagSpace(tag.tag_id)'>#{{getTagName(tag.tag_id)}}
					<md-tooltip md-visible="false" md-delay="400" md-direction="bottom" md-autohide="true">
					  	{{ tag.users.length }} user(s) tagged this post as {{getTagName(tag.tag_id)}}
					</md-tooltip>
					</span>
				</div> -->

				<md-divider></md-divider>

				<div class='post-body'>	

					<!-- content -->
					<div ng-bind-html='post_details.body'></div>

					<!-- Attachments - if present -->
		            <div ng-if='post_details.attachments[0].id!=null'>
		                <b>Attachments ({{post_details.attachments.length}} files)</b>
		                <div ng-repeat="attachment in post_details.attachments">
		                  <a href="/api/contributions/{{post_details.id}}/attachments/{{attachment.id}}" target=_blank>
		                    <div layout='row'>
		                      <div class='flex-10 attachment-thumb' ng-style='getThumb(post_details.id, attachment.attachment).style'></div>
		                      <div class='flex-90'>
		                          <div class='attachment-details' style='margin-left: 20px;'>
		                            <h4>{{attachment.attachment.name}}</h4>
		                            <div style='font-size: 12px; color: #333;'>Size: {{ (attachment.attachment.size/1000000).toFixed(2) }} MB </div>
		                          </div>
		                      </div>
		                    </div>
		                  </a>
		                </div>
		            </div>


				</div>

			</md-card>

			<md-card class='post-details comments' layout='column' style="margin-top: 20px;">

				<!-- comments -->
				<h3 style='line-height: 18px; font-size: 14px; margin-bottom: 15px;'>
	            	<span ng-if='post_details.comments[0].id != null'>Comments ({{ post_details.comments.length }}) <md-divider></md-divider></span>
	            	<span ng-if='post_details.comments[0].id == null'>This post has no comments yet.</span>
	            </h3>


	            <!-- post-functions -->
	            <div class='comment' style='margin-bottom: 20px;' ng-repeat='comment in post_details.comments | orderBy: "date"' ng-init='u = getUser(comment.createdBy)' ng-if='post_details.comments[0].id != null' layout='row'>
	                
	                <div flex='10'>
	                	<img src='{{u.avatar}}' style='height: 45px; width: 45px; border-radius: 50%; vertical-align: middle;'>
	                </div>

	                <div flex='90'>
		                <span style='font-size: 10px; color: #8C8A8A;'>{{comment.date | date : 'medium'}}</span><br>
		                <b>{{u.nickname ? u.nickname : u.name}}</b> said:
		                <div ng-bind-html="comment.body"></div>
		                
		                <div class='pointer' style='font-size: 10px; color: blue;' ng-if='comment.createdBy == user.id' ng-click='delete(comment.id, true)'>[ Delete ]</div>
	                </div>

	            </div>

			</md-card>


		</div>
	</div>

	<div class='side-details' flex="20">

		<div class='container' layout-margin>

			<!-- navigation -->
			<div class='post-actions' layout="row" layout-align='center'  layout-wrap>
				
				<div class='action' ng-click='backToTop()'>
					<ng-md-icon icon="keyboard_arrow_up" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Up</md-tooltip>
				</div>

				<div class='action' ng-click='goToEnd()'>
					<ng-md-icon icon="keyboard_arrow_down" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Down</md-tooltip>
				</div>

				<div class='action'>
					<a onclick='history.back()'>
						<ng-md-icon icon="keyboard_arrow_left" size='16' style="fill: #5A5A5A"></ng-md-icon>
		             	<md-tooltip md-direction="bottom">Back</md-tooltip>
	             	</a>
				</div>

				<div class='action'>
					<a ng-click='goToSpaceWithArgs(query)'>
						<ng-md-icon icon="first_page" size='16' style="fill: #5A5A5A"></ng-md-icon>
		             	<md-tooltip md-direction="bottom">Back to Search</md-tooltip>
	             	</a>
				</div>

			</div>
      		<div style="float: right; height: 100% width:40%;  margin-right: 0px">
			<h3 style='line-height: 18px; font-size: 14px;'>
                About the author
            </h3>
			<div layout="row">
				<img class='author-profile-picture main' src='{{auth.avatar}}'>
				<div class='author-name main'>
					<a ui-sref='home.profile-details({address: post_details.createdBy})' ng-init='auth = getUser(post_details.createdBy)'> 
					{{ auth.nickname ? auth.nickname : auth.name }}
					</a>
				</div>
			</div>

			<div layout='column'>
				<span style='font-size: 10px;'>Created: {{post_details.date | date: 'mediumDate' }}</span>
				<span style='font-size: 10px;'>Views: {{post_details.views[0].id !== null ? post_details.views.length : 0}}</span>
				<span style='font-size: 10px;'>Likes: {{post_details.likes[0].id !== null ? post_details.likes.length : 0}}</span>
				<span style='font-size: 10px;'>Bookmarks: {{post_details.bookmarks[0].id !== null ? post_details.bookmarks.length : 0}}</span>
			</div>

			<div class='tags'>
				<span style='line-height: 14px; font-size: 12px;' class='pointer' ng-repeat='tag in post_details.tags | orderBy : "users"' ng-if='getTagName(tag.tag_id).length>0' ng-click='goToTagSpace(tag.tag_id)'>#{{getTagName(tag.tag_id)}}
				<md-tooltip md-visible="false" md-delay="400" md-direction="bottom" md-autohide="true">
				  	{{ tag.users.length }} user(s) tagged this post as {{getTagName(tag.tag_id)}}
				</md-tooltip>
				</span>
				<div style='line-height: 14px; font-size: 10px;color: #6C6969; text-align: center;' ng-if='post_details.tags.length == 0'>This post is not published in any space.</div>
			</div>



			<!-- reactions -->
			<div class='post-actions' layout="row" layout-align='center'  layout-wrap>
				
				<div class='action' ng-if='post_details.createdBy != user.id;' 
					ng-click='post_details.status.indexOf("liked") > -1 ? unlike(post_details.id) : like(post_details.id)' ng-class='post_details.status.indexOf("liked") > -1 ? "selected" : "unselected" '>
					<ng-md-icon icon="thumb_up" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom" ng-if='post_details.status.indexOf("liked") > -1'> You've liked this post!</md-tooltip>
	             	<md-tooltip md-direction="bottom" ng-if='post_details.status.indexOf("liked") == -1'> Like this post!</md-tooltip>
				</div>

				<div class='action' ng-click='comment(post_details)'>
					<ng-md-icon icon="chat_bubble" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Comment</md-tooltip>
				</div>

				<div class='action' ng-click='reply(post_details)'>
					<ng-md-icon icon="reply" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Reply</md-tooltip>
				</div>

				<div class='action' ng-click='edit(post_details)' ng-if='post_details.createdBy == user.id;'>
					<ng-md-icon icon="mode_edit" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Edit</md-tooltip>
				</div>

				<div class='action' ng-if='post_details.children[0].id == null && post_details.comments[0].id == null && post_details.createdBy == user.id;' ng-click='delete(post_details.id)'>
					<ng-md-icon icon="delete" size='16' style="fill: #5A5A5A"></ng-md-icon>
	             	<md-tooltip md-direction="bottom">Delete</md-tooltip>
				</div>


			</div>
			</div>
			</div>
			</div>
			</div>

			<md-divider></md-divider>

			<h3 style='line-height: 16px; font-size: 12px;'>
               	Predecessors
            </h3>
          </div>
			<!-- parent -->
			<div class='linked-post-container parent' layout='row' layout-wrap dnd-list dnd-drop='linkNewParent(item, post_details.id)'>
				
				<!-- <md-button class="md-mini" aria-label="switch-parent" md-no-ink="false" md-ripple-size="auto" ng-click='parent - 1 >= 0 ? parent=parent-1 :  null'>
					<ng-md-icon icon="keyboard_arrow_left" size='12' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent > 0 '></ng-md-icon>
				</md-button> -->
				<a class='nav-btn' ng-click='parent - 1 >= 0 ? parent=parent-1 :  null' ng-class='post_details.parents[parent].id!=null && parent > 0 ? "" : "clear"'>
					<!-- <ng-md-icon icon="keyboard_arrow_left" size='12' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent > 0 '></ng-md-icon> -->
				</a>
				
				<md-card class='post-details pointer' layout='column' flex ng-click='goToNode(post_details.parents[parent].id)' ng-if='post_details.parents[parent].id!=null'>
					<div class='post-title linked'>{{parent+1}} | {{post_details.parents.length }} {{post_details.parents[parent].title}} </div>
					<div layout="row">
						<img class='author-profile-picture linked' src='{{getUser(post_details.parents[parent].createdBy).avatar}}'>
						<div class='author-name linked'>{{getUser(post_details.parents[parent].createdBy).name}}

						</div>
					</div>
				</md-card>


				<md-card class='post-details pointer' layout='column' flex ng-if='post_details.parents[parent].id==null'>
				<div class='post-subtitle linked'>This post has no preceeding posts. Drop a post here to link 	a parent.
				</div>
					</md-card>

				<a class='nav-btn' ng-click='parent + 1 < post_details.parents.length ? parent=parent+1: null' ng-class='post_details.parents[parent].id!=null && parent<post_details.parents.length-1 ? "" : "clear"'>
					<!-- <ng-md-icon icon="keyboard_arrow_right" size='12' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent<post_details.parents.length-1'></ng-md-icon> -->
				</a>

				</div>
				<!-- <md-button class="md-mini" aria-label="switch-parent" md-no-ink="false" md-ripple-size="auto" ng-click='parent + 1 < post_details.parents.length ? parent=parent+1: null'>
					<ng-md-icon icon="keyboard_arrow_right" size='24' style="fill: #222" ng-if='post_details.parents[parent].id!=null && parent<post_details.parents.length-1'></ng-md-icon>
				</md-button> -->

			</div>


			<h3 style='line-height: 16px; font-size: 12px;'>
                Successors
            </h3>

			<!-- children -->
			<div class='linked-post-container child' layout='row' layout-wrap dnd-list dnd-drop='linkNewChild(item, post_details.id)'>
				
				<!-- <md-button class="md-mini" aria-label="switch-child" md-no-ink="false" md-ripple-size="auto" ng-click='child - 1 >= 0 ? child=child-1 :  null'>
					<ng-md-icon icon="keyboard_arrow_left" size='24' style="fill: #222" ng-if='post_details.children[child].id!=null && child>0'></ng-md-icon>
				</md-button> -->
				
				<a class="nav-btn" ng-click='child - 1 >= 0 ? child=child-1 :  null' ng-class='post_details.children[child].id!=null && child>0 ? "" : "clear"'>
					<!-- <ng-md-icon icon="keyboard_arrow_left" size='12' style="fill: #222" ng-if='post_details.children[child].id!=null && child>0'></ng-md-icon> -->
				</a>

				<md-card class='post-details pointer' layout='column' flex ng-click='goToNode(post_details.children[child].id)' ng-if='post_details.children[child].id!=null'>
					<div class='post-title linked'>{{child+1}} | {{post_details.children.length }} {{post_details.children[child].title}} </div>
					<div layout="row">
						<img class='author-profile-picture linked' src='{{getUser(post_details.children[child].createdBy).avatar}}'>
						<div class='author-name linked'>{{getUser(post_details.children[child].createdBy).name}}</div>
					</div>
				</md-card>


				<md-card class='post-details pointer' layout='column' flex ng-if='post_details.children[child].id==null'>
					<div class='post-subtitle linked'>This post has no replies. Drop a post here to link a child.</div>
				</md-card>

				<!-- <md-button class="md-mini" aria-label="switch-child" md-no-ink="false" md-ripple-size="auto" ng-click='child + 1 < post_details.children.length ? child=child+1: null'>
					<ng-md-icon icon="keyboard_arrow_right" size='24' style="fill: #222" ng-if='post_details.children[child].id!=null && child<post_details.children.length-1'></ng-md-icon>
				</md-button> -->

				<a class='nav-btn' ng-click='child + 1 < post_details.children.length ? child=child+1: null' ng-class='post_details.children[child].id!=null && child<post_details.children.length-1 ? "" : "clear"'>
					<!-- <ng-md-icon icon="keyboard_arrow_right" size='24' style="fill: #222" ng-if='post_details.children[child].id!=null && child<post_details.children.length-1'></ng-md-icon> -->
				</a>

			</div>

		
		

	</div>
	</div>

</div>


<!-- comments dialog box -->
<div style="visibility: hidden">
<div class="md-dialog-container comment-box" id="commentDialog">
  <md-dialog layout-padding>
    <h2>Chit-Chat!</h2>
    <h4>Comments are short ... if you want to write more, create a reply!</h4>
  	<!--body -->
    <div class="textAngular" text="Enter your text here" style="border-width:5px;  border-style:grove; max-width: 100%; width: 600px; overflow-x: scroll">
      <!-- <text-angular ng-model="contributionData.body" class="textAngular"> -->
      <my-awns ng-model="result"></my-awns>
    </div>
    <md-dialog-actions layout="row" layout-align='center'> 
    	<md-button md-autofocus ng-click='answer(result)'>Create</md-button>
      	<md-button ng-click='cancel()'>Discard</md-button>
    </md-dialog-actions>
  </md-dialog>

</div>
</div>